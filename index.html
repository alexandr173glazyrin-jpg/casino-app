<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        :root {
            --gold: linear-gradient(135deg, #f39c12, #f1c40f);
            --dark-bg: #0f0f13;
            --card-bg: #1a1a24;
            --accent: #7d5fff;
        }

        body {
            background-color: var(--dark-bg);
            color: white;
            font-family: 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            min-height: 100vh;
            overflow: hidden;
            user-select: none;
        }

        .header {
            margin-bottom: 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 24px;
            text-transform: uppercase;
            letter-spacing: 2px;
            background: var(--gold);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin: 0;
        }

        /* –†–µ–∂–∏–º—ã –∏–≥—Ä—ã */
        .modes {
            display: flex;
            gap: 10px;
            margin-bottom: 30px;
        }

        .mode-btn {
            background: var(--card-bg);
            border: 2px solid #333;
            color: #888;
            padding: 8px 15px;
            border-radius: 12px;
            font-size: 12px;
            cursor: pointer;
            transition: 0.3s;
        }

        .mode-btn.active {
            border-color: var(--accent);
            color: white;
            box-shadow: 0 0 10px rgba(125, 95, 255, 0.4);
        }

        /* –†—É–ª–µ—Ç–∫–∞ */
        .roulette-wrapper {
            position: relative;
            width: 100%;
            max-width: 350px;
            height: 120px;
            background: var(--card-bg);
            border-radius: 20px;
            border: 2px solid #2d2d3d;
            overflow: hidden;
            box-shadow: inset 0 0 30px rgba(0,0,0,0.8);
        }

        .selector {
            position: absolute;
            left: 50%;
            top: 0;
            width: 4px;
            height: 100%;
            background: var(--accent);
            z-index: 100;
            transform: translateX(-50%);
            box-shadow: 0 0 15px var(--accent);
        }

        .selector::after {
            content: '';
            position: absolute;
            top: -5px;
            left: -3px;
            border-left: 5px solid transparent;
            border-right: 5px solid transparent;
            border-top: 8px solid var(--accent);
        }

        .tape {
            display: flex;
            align-items: center;
            position: absolute;
            height: 100%;
            left: 0;
            will-change: transform;
            transition: transform 5s cubic-bezier(0.15, 0, 0.05, 1);
        }

        .item {
            min-width: 90px;
            height: 80px;
            margin: 0 5px;
            background: #252535;
            border-radius: 12px;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 18px;
            border-bottom: 4px solid #3d3d5d;
        }

        .item img { width: 30px; margin-bottom: 5px; }
        
        /* –¶–≤–µ—Ç–∞ —Ä–µ–¥–∫–æ—Å—Ç–∏ */
        .rare-low { border-color: #555; }
        .rare-med { border-color: #3498db; color: #3498db; }
        .rare-high { border-color: #9b59b6; color: #9b59b6; }
        .rare-legend { border-color: #f1c40f; color: #f1c40f; text-shadow: 0 0 5px rgba(241, 196, 15, 0.5); }

        .spin-button {
            margin-top: 40px;
            width: 200px;
            height: 55px;
            background: var(--accent);
            border: none;
            border-radius: 15px;
            color: white;
            font-size: 18px;
            font-weight: bold;
            box-shadow: 0 5px 20px rgba(125, 95, 255, 0.4);
            cursor: pointer;
            transition: 0.2s;
        }

        .spin-button:active { transform: scale(0.95); }
        .spin-button:disabled { background: #444; box-shadow: none; opacity: 0.6; }

        .win-announcement {
            position: absolute;
            top: 20%;
            font-size: 32px;
            font-weight: bold;
            opacity: 0;
            transform: translateY(20px);
            transition: 0.5s;
        }

        .win-announcement.show {
            opacity: 1;
            transform: translateY(0);
        }
    </style>
</head>
<body>

    <div class="win-announcement" id="winTxt">–í–´–ò–ì–†–´–®!</div>

    <div class="header">
        <h1>Quatro Premium</h1>
    </div>

    <div class="modes">
        <div class="mode-btn active" onclick="setMode('classic', 50, this)">–ö–õ–ê–°–°–ò–ö</div>
        <div class="mode-btn" onclick="setMode('risk', 100, this)">–†–ò–°–ö</div>
        <div class="mode-btn" onclick="setMode('jackpot', 500, this)">JACKPOT</div>
    </div>

    <div class="roulette-wrapper">
        <div class="selector"></div>
        <div id="tape" class="tape"></div>
    </div>

    <button class="spin-button" id="spinBtn" onclick="startSpin()">–ö–†–£–¢–ò–¢–¨ (50 ü™ô)</button>

    <script>
        const tg = window.Telegram.WebApp;
        tg.expand();

        const tape = document.getElementById('tape');
        const spinBtn = document.getElementById('spinBtn');
        const winTxt = document.getElementById('winTxt');
        
        let currentMode = 'classic';
        let isSpinning = false;

        const config = {
            classic: { cost: 50, prizes: [10, 20, 50, 60, 100, 150] },
            risk: { cost: 100, prizes: [0, 5, 10, 200, 500, 1000] },
            jackpot: { cost: 500, prizes: [100, 200, 500, 1000, 2500, 5000] }
        };

        function setMode(mode, cost, btn) {
            if(isSpinning) return;
            currentMode = mode;
            document.querySelectorAll('.mode-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            spinBtn.innerText = `–ö–†–£–¢–ò–¢–¨ (${cost} ü™ô)`;
            generateItems();
        }

        function getRareClass(val) {
            if (val >= 1000) return 'rare-legend';
            if (val >= 250) return 'rare-high';
            if (val >= 100) return 'rare-med';
            return 'rare-low';
        }

        function generateItems() {
            tape.innerHTML = '';
            const prizes = config[currentMode].prizes;
            // –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º 80 —ç–ª–µ–º–µ–Ω—Ç–æ–≤ –¥–ª—è –ø–ª–∞–≤–Ω–æ—Å—Ç–∏
            for(let i = 0; i < 80; i++) {
                const val = prizes[Math.floor(Math.random() * prizes.length)];
                const item = document.createElement('div');
                item.className = `item ${getRareClass(val)}`;
                item.innerHTML = `<span>${val}</span><small>ü™ô</small>`;
                tape.appendChild(item);
            }
            tape.style.transition = 'none';
            tape.style.transform = 'translateX(0)';
        }

        function startSpin() {
            if(isSpinning) return;
            
            isSpinning = true;
            spinBtn.disabled = true;
            winTxt.classList.remove('show');
            
            // –ò—Å–ø–æ–ª—å–∑—É–µ–º Haptic Feedback (–≤–∏–±—Ä–∞—Ü–∏—è –ø—Ä–∏ –Ω–∞—á–∞–ª–µ)
            if(tg.HapticFeedback) tg.HapticFeedback.impactOccurred('heavy');

            const itemWidth = 100; // 90px + 10px margin
            const winningIndex = 60 + Math.floor(Math.random() * 10);
            const centerOffset = (window.innerWidth / 2) - (itemWidth / 2);
            const finalPosition = -(winningIndex * itemWidth) + centerOffset;

            tape.style.transition = 'transform 5s cubic-bezier(0.15, 0, 0.05, 1)';
            tape.style.transform = `translateX(${finalPosition}px)`;

            setTimeout(() => {
                const winner = tape.children[winningIndex];
                const winValue = winner.querySelector('span').innerText;
                
                winTxt.innerText = `+ ${winValue} ü™ô`;
                winTxt.classList.add('show');
                
                if(tg.HapticFeedback) tg.HapticFeedback.notificationOccurred('success');

                setTimeout(() => {
                    tg.sendData(winValue);
                }, 1500);
            }, 5200);
        }

        // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
        generateItems();
    </script>
</body>
</html>
